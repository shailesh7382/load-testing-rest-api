= FX Pricing & Booking REST API

A Spring Boot REST API for pricing (quotes) and booking (trades) of FX trades, supporting a comprehensive set of attributes for both quote and trade entities.

== Features

- Create and retrieve FX Quotes with detailed attributes
- Book and retrieve FX Trades with extensive trade details
- In-memory H2 database for easy development and testing
- JPA/Hibernate for persistence
- RESTful endpoints for integration and automation
- Comprehensive OpenAPI 3.0 specification for API documentation
- Interactive Swagger UI for API exploration and testing

== Project Structure

This project uses a multi-module Maven structure:

- **Parent POM** (root): Defines common properties and modules
- **fx-api**: Contains the FX Pricing & Booking REST API implementation

=== Module Overview

[source]
----
load-testing-rest-api/          # Parent POM
├── pom.xml                     # Parent POM file
└── fx-api/                     # API implementation module
    ├── pom.xml                 # Module POM file
    ├── src/                    # Source code
    ├── openapi.yaml            # OpenAPI specification
    └── load-testing.adoc       # Load testing documentation
----

== Getting Started

=== Prerequisites

- Java 21+
- Maven 3.6+

=== Build & Run

To build all modules:

[source,shell]
----
mvn clean install
----

To run the fx-api module:

[source,shell]
----
cd fx-api
mvn spring-boot:run
----

Or from the root directory:

[source,shell]
----
mvn spring-boot:run -pl fx-api
----

The API will be available at http://localhost:8080.

=== API Documentation

The application includes **Swagger UI** for interactive API documentation and testing.

==== Swagger UI

Once the application is running, access Swagger UI at:

[source]
----
http://localhost:8080/swagger-ui.html
----

Swagger UI provides:

- Interactive API documentation with all endpoints
- Try-it-out functionality to test APIs directly from the browser
- Complete request/response schemas
- Example payloads for all operations
- Automatic API documentation generated from code annotations

==== OpenAPI Specification

The complete OpenAPI 3.0 specification is also available:

- **API Docs JSON**: http://localhost:8080/v3/api-docs
- **Static YAML file**: `fx-api/openapi.yaml` in the repository

You can also view the static specification using external tools:

- **Swagger Editor**: https://editor.swagger.io/ (paste the content of `fx-api/openapi.yaml`)
- **Redoc**: https://redocly.github.io/redoc/ (load `fx-api/openapi.yaml`)

The specification includes:

- All Quote and Trade endpoints with detailed descriptions
- Complete request/response schemas
- Example requests and responses
- Parameter descriptions and validation rules

=== H2 Console

Access the H2 database console at http://localhost:8080/h2-console
JDBC URL: `jdbc:h2:mem:fxdb`
User: `sa`
Password: (leave blank)

== API Endpoints

=== Quotes

- `GET /api/quotes` — List all quotes
- `GET /api/quotes/{id}` — Get quote by ID
- `POST /api/quotes` — Create a new quote
- `PUT /api/quotes/{id}` — Update an existing quote
- `DELETE /api/quotes/{id}` — Delete a quote
- `GET /api/quotes/currency/{currencyPair}` — Filter quotes by currency pair (use URL encoding for slashes)
- `GET /api/quotes/status/{status}` — Filter quotes by status
- `GET /api/quotes/count` — Get total quote count
- `GET /api/quotes/search?currencyPair={pair}&status={status}` — Search quotes with optional filters
- `POST /api/quotes/rfq` — Request for quote (RFQ) with simulated pricing

Example JSON for creating a quote:
[source,json]
----
{
  "currencyPair": "EUR/USD",
  "bid": 1.1234,
  "ask": 1.1240,
  "mid": 1.1237,
  "quoteProvider": "ProviderX",
  "quoteTime": "2024-06-01T12:34:56",
  "venue": "VenueA",
  "liquidityProvider": "LP1",
  "quoteId": "Q12345",
  "tenor": "SPOT",
  "settlementType": "T+2",
  "quoteStatus": "ACTIVE",
  "sourceSystem": "SystemA",
  "pricingModel": "Model1",
  "priceType": "Firm",
  "marketDataSource": "MarketX",
  "quoteCondition": "Normal",
  "quoteOrigin": "Internal",
  "quoteType": "Indicative",
  "quoteLevel": "Level1",
  "quoteSide": "Buy",
  "quoteChannel": "API",
  "quoteVersion": "1",
  "quoteReference": "Ref123",
  "quoteComment": "Sample quote"
}
----

=== Trades

- `GET /api/trades` — List all trades
- `GET /api/trades/{id}` — Get trade by ID
- `POST /api/trades` — Book a new trade
- `PUT /api/trades/{id}` — Update an existing trade
- `DELETE /api/trades/{id}` — Delete a trade
- `GET /api/trades/currency/{currencyPair}` — Filter trades by currency pair (use URL encoding for slashes)
- `GET /api/trades/status/{status}` — Filter trades by status
- `GET /api/trades/count` — Get total trade count
- `GET /api/trades/volume/{currencyPair}` — Get total trade volume by currency pair
- `GET /api/trades/search?currencyPair={pair}&status={status}` — Search trades with optional filters

Example JSON for booking a trade:
[source,json]
----
{
  "tradeId": "T12345",
  "currencyPair": "EUR/USD",
  "notional": 1000000,
  "direction": "BUY",
  "price": 1.1237,
  "counterparty": "BankA",
  "tradeDateTime": "2024-06-01T12:35:00",
  "trader": "Trader1",
  "book": "BookA",
  "status": "CONFIRMED",
  "settlementType": "T+2",
  "settlementDate": "2024-06-03",
  "tradeType": "SPOT",
  "executionVenue": "VenueA",
  "sourceSystem": "SystemA",
  "tradeReference": "RefT123",
  "tradeComment": "Sample trade",
  "tradeVersion": "1",
  "tradeChannel": "API",
  "tradeStrategy": "Strategy1",
  "tradeDesk": "Desk1",
  "tradeOrigin": "Internal",
  "tradeLevel": "Level1",
  "tradeSide": "Buy",
  "tradeCondition": "Normal",
  "tradeCategory": "Category1",
  "tradeSubType": "SubTypeA",
  "tradeBookType": "BookTypeA"
}
----

== Testing

Run all tests from the root directory:
[source,shell]
----
mvn test
----

Or run tests for a specific module:
[source,shell]
----
cd fx-api
mvn test
----

== Load Testing

A simple load testing framework is provided using JUnit and Rest Assured.

To run the load tests (ensure the application is running on http://localhost:8080):

[source,shell]
----
mvn test -Dtest=com.example.fx.load.LoadTest -pl fx-api
----

Or from within the fx-api directory:
[source,shell]
----
cd fx-api
mvn test -Dtest=com.example.fx.load.LoadTest
----

This will simulate concurrent quote creation and trade booking using multiple threads, as described in `fx-api/load-testing.adoc`.
You can adjust concurrency and request count in `LoadTest.java`.

== License

MIT License.
